# Readme

## Setting up the workspace
* Navigate to Cloud9 and sign up for an account
* Create a new workspace and choose the Blank template
* Familiarize yourself with the IDE

## Installing meteor in the workspace
Run the following command in the bash terminal. Meteor will be downloaded and installed, iyt will take a few minutes
```
curl https://install.meteor.com/ | sh
```

Create a new meteorapp
```
meteor create .
meteor npm install --save babel-runtime
```

Run the meteor app
```
meteor --port $IP:$PORT
```
The application is now launched and deployed. It is publicly accessible by the following url:
```
https://[workspace-name]-[username].c9users.io/
```
Replace [workspace-name] with the workspace name 
and [username] with your username and navigate to the url to verify that the application is deployed correctly. You will
see some default content generated by the meteor create command.

The first time the application is launched it will take a few mminutes. The application will run until you press CTRL+C in the terminal.
The IDE will automatically detect changes to the application and relaunch it automatically. Those relaunches happens in a few seconds.


## Creating the chat app - running the application
* Update the `client/main.html` with:

```
<head>
    <title>ChatApp</title>
</head>

<body>
  <h1>ChatApp</h1>
  
  {{> welcome}}
</body>

<template name="welcome">
    <p>Welcome to the example chat app!</p>
</template>
```
* Also remove the code in `client\main.js` to make it look like:

```
import './main.html';
```

* If not already launched, launch the application by typing `meteor --port $IP:$PORT` in the terminal
* Your application should now be running at `https://<workspace>-<user>.c9users.io/`

## Adding the data storage
* Create an `imports/api/messages.js`-file with the following content:

```
import { Mongo } from 'meteor/mongo';

export const Messages = new Mongo.Collection('messages');
```

* Import the Mongo.Collection into `server/main.js`

```
import { Messages } from '../imports/api/messages.js';
```

* And into `client/main.js`

```
import { Messages } from '../imports/api/messages.js';
```

* Add the html to show messages in `client/main.html`:

```
<template name="messages">
  {{#each messages}}
    <strong>{{name}}:</strong>{{message}}<br>
  {{/each}}
</template>
```

* Also, make sure to add the template to the rendered HTML:

```
{{> messages}}
```

* And add the helper function for the template in client/main.js:

```
import { Template } from 'meteor/templating';

Template.messages.helpers({
  messages: function() { 
    return Messages.find({}, {sort: {time: -1 }});
  }
});
```


* Finally, test the code by injecting a message into the data store
* * Open a new terminal window and start a mongo console: `meteor mongo`
* * Insert a message using `db.messages.insert({ name :  "Anonymous" ,  message : "My first message", time: Date.now()});`
* * See the message display in your application!

## Add ability to post messages
* Add the input field template to `client/main.html`

```
<template name="input">
  <p>Message: <input type="text" id="message"></p>
</template>
```
* Add the template to the rendered HTML

```
{{> input}}
```

* And add the template events helper in `client/main.js`

```
Template.input.events = {
 'keydown input#message': function(event) {
    if (event.which == 13) {  // 13 is the enter key event
      var name  =  'Anonymous' ;
      var message = event.target;
      if (message.value != '')  {
        Messages.insert({name: name, message: message.value, time:  Date.now()});
        message.value = '' ;
      }
    }
  } 
}
```

* Test the application by posting a message!
* Find a fellow coder and ask him/her to navigate to your application and post a reply!
